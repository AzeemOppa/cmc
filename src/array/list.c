#include <stdlib.h>#include "list.h"/******************************************************************************/void list_get_4_values(const int * a, int * x0, int * x1, int * x2, int * x3){  *x0 = a[0];  *x1 = a[1];  *x2 = a[2];  *x3 = a[3];}void list_set_4_values(int * a, int x0, int x1, int x2, int x3){  a[0] = x0;  a[1] = x1;  a[2] = x2;  a[3] = x3;}/******************************************************************************/int list_position_count(int * arr, int n, int element){  int i, total;    total = 0;  for (i = 0; i < n; ++i)    if (element == arr[i])      ++total;  return total;}void list_position_members(int ** result_pointer, const int * arr,                           int n, int element, int total){  int i, result_index;    if (total == 0)  {    *result_pointer = NULL;    return;  }  *result_pointer = (int *) malloc(total * sizeof(int));  result_index = 0;  for (i = 0; i < n; ++i)    if (element == arr[i])    {      (*result_pointer)[result_index] = i;      ++result_index;    }}/******************************************************************************/int list_member(const jagged1 * arr, int element){  int arr_a0, i;  int * arr_a1;  arr_a0 = arr->a0;  arr_a1 = arr->a1;  for (i = 0; i < arr_a0; ++i)    if (element == arr_a1[i])      return 1;  return 0;}int list_position(const jagged1 * arr, int element){  int arr_a0, i;  int * arr_a1;    arr_a0 = arr->a0;  arr_a1 = arr->a1;  for (i = 0; i < arr_a0; ++i)    if (element == arr_a1[i])      return i;  return -1;}static int int_compare(const void * a, const void * b){  int res;  int * a_int, * b_int;    a_int = (int *) a;  b_int = (int *) b;  res = *a_int - *b_int;  return res;}jagged1 * list_delete_duplicates(jagged1 * arr){  int arr_a0, i, ind, result_a0;  int * arr_a1, * result_a1;  jagged1 * result;    arr_a0 = arr->a0;  arr_a1 = arr->a1;  result = (jagged1 *) malloc(sizeof(jagged1));  /* NULL pointer check */  result_a0 = 1;  qsort(arr_a1, arr_a0, sizeof(int), int_compare);  for (i = 0; i < arr_a0 - 1; ++i)    if (arr_a1[i] < arr_a1[i + 1])      ++result_a0;  result_a1 = (int *) malloc(result_a0 * sizeof(int));  /* NULL pointer check */  result_a1[0] = arr_a1[0];  ind = 1;  for (i = 0; i < arr_a0 - 1; ++i)    if (arr_a1[i] < arr_a1[i + 1])    {      result_a1[ind] = arr_a1[i + 1];      ++ind;    }  jagged1_set(result, result_a0, result_a1);  return result;}/******************************************************************************/int list_sum(const int * a, int begin, int end){  int i, result;    result = 0;  for (i = begin; i < end; ++i)    result += a[i];  return result;}int list_product(const int * a, int begin, int end){  int i, result;    result = 1;  for (i = begin; i < end; ++i)    result *= a[i];  return result;}/******************************************************************************/int list_signature(const jagged1 * arr){  int arr_a0, i, inversions, j;  int * arr_a1;  arr_a0 = arr->a0;  arr_a1 = arr->a1;  inversions = 0;  for (i = 0; i < arr_a0 - 1; ++i)    for (j = i + 1; j < arr_a0; ++j)      if (arr_a1[i] > arr_a1[j])        ++inversions;  return ((inversions % 2 == 0) ? 1 : -1);}int list_complement_simplicial(const jagged1 * cell_nodes,                               const jagged1 * hyperface_nodes){  int cell_nodes_a0, i;  int * cell_nodes_a1;  cell_nodes_a0 = cell_nodes->a0;  cell_nodes_a1 = cell_nodes->a1;  for (i = 0; i < cell_nodes_a0; ++i)    if(!list_member(hyperface_nodes, cell_nodes_a1[i]))      return cell_nodes_a1[i];  return -1;}void list_delete(jagged1 * result, const jagged1 * arr, int position){  int i, result_a0;  int * arr_a1, * result_a1;  result_a0 = result->a0;  result_a1 = result->a1;  arr_a1 = arr->a1;  for (i = 0; i < position; ++i)    result_a1[i] = arr_a1[i];  for (i = position; i < result_a0; ++i)    result_a1[i] = arr_a1[i + 1];}int list_relative_sign(const jagged1 * cell_nodes,                       const jagged1 * hyperface_nodes){  int rest_node, rest_node_position, sign0, sign1, sign2;  int hyperface_nodes_messed_a1[4];  jagged1 hyperface_nodes_messed;  rest_node = list_complement_simplicial(cell_nodes, hyperface_nodes);  rest_node_position = list_position(cell_nodes, rest_node);  hyperface_nodes_messed.a0 = hyperface_nodes->a0;  hyperface_nodes_messed.a1 = hyperface_nodes_messed_a1;  list_delete(&hyperface_nodes_messed, cell_nodes, rest_node_position);  sign0 = (rest_node_position % 2 == 0) ? 1 : -1;  sign1 = list_signature(&hyperface_nodes_messed);  sign2 = list_signature(hyperface_nodes);  return sign0 * sign1 * sign2;}