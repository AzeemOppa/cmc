\begin{formulation}
  \label{idec/diffusion/discrete/transient/primal_weak-formulation}
  [Primal weak formulation for the transient discrete heat equation
    with discrete differential forms]
  The following formulation is a discrete version of
  \Cref{idec/diffusion/continuous/transient/primal_weak-formulation}.
  Let:
  \begin{itemize}
    \item
      Let $d$ be a positive integer (space dimension);
    \item
      $K$ be an oriented quasi-cubical \hyperref[idec:mesh:definition]{mesh} of
      dimension $d$ representing the material body;
    \item
      $[K]$ be the fundamental class of $K$;
    \item
      $t_0 \in \R$ be the initial time;
    \item
      $I = [t_0, \infty)$;
    \item
      $f^d [E T^{-1}] \colon I \to C^d K$ be the heat source;
    \item
      $u_0 [\Theta] \in C^0 K$ be the initial temperature;
    \item
      $\pi_0 [E L^{-d} \Theta^{-1}] \colon I \times C^0 K \to C^0 K$
      be the heat capacity of the material;
    \item
      $\tilde{\kappa}_1 [E L^{2 - d} T^{-1} \Theta^{-1}]
      \colon I \times C^1 K \to C^1 K$
      be the thermal conductivity of the material, such that at any moment
      $t \in I$ and for any edge $c_1 \in K_1$, there exists some $\lambda > 0$
      such that $\tilde{\kappa}_1(c^1) = \lambda c^1$;
    \item
      $\partial K = \Gamma_D \cup \Gamma_N$ be the partition of the boundary of
      $K$ into Dirichlet ($\Gamma_D$) and Neumann ($\Gamma_N$) regions;
    \item
      $[\Gamma_N]$ be the fundamental class of $\Gamma_N$, where $\Gamma_N$
      has the boundary orientation induced from $K$;
    \item
      $g_D^0 [\Theta] \colon I \to C^0 \Gamma_D$
      be the prescribed temperature on the Dirichlet boundary;
    \item
      $g_N^{d - 1} [E T^{-1}] \colon I \to C^{d - 1} \Gamma_N$
      be the prescribed flow rate on the Neumann boundary.
  \end{itemize}
  define the following operators:
  \begin{subequations}
    \begin{alignat}{3}
      & A \colon C^0 K \times (I \to C^0 K) \to \R, \quad
      && A(v^0, w^0)
        := \inner{\delta_0 v^0}{\tilde{\kappa}_1 \delta_0 w^0}_{K, 0} \qquad
      && [E T^{-1} \Theta^{-1}], \\
%
      & B \colon C^0 K \times (I \to C^0 K) \to \R, \quad
      && B(v^0, w^0) := \inner{v^0}{\pi_0 w^0}_{K, 0} \qquad
      && [E \Theta^{-1}], \\
%
      & G \colon C^0 K \to \R, \quad
      && G(v^0) := (\tr_{\Gamma_N} v^0 \smile g_N^{d - 1})[\Gamma_N] \qquad
      && [E T^{-1}], \\
%
      & F \colon C^0 K \to \R, \quad
      && F(v^0) := (v^0 \smile f^d)[K] \qquad
      && [E T^{-1}].
    \end{alignat}
  \end{subequations}
  Our unknowns is temperature $u^0 [\Theta] \colon I \to C^0 K$.
  We are solving the following problem for $u^0$:
  \begin{subequations}
    \begin{alignat}{4}
      & \forall v^0 [\Theta] \in \Ker \tr_{\Gamma_D, 0}, \quad
      && B(v^0, \frac{\partial u^0} {\partial t}) + A(v^0, u^0)
      && = G(v^0) + F(v^0) \qquad
      && [E T^{-1} \Theta], \\
%
      &
      && \tr_{\Gamma_D, 0} u^0
      && = g_D^0 \qquad
      && [\Theta], \\
%
      &
      && u^0(t_0)
      && = u_0 \qquad
      && [\Theta].
    \end{alignat}
  \end{subequations}
  The flow rate $q^{d - 1} [E T^{-1}] \colon I \to C^{d - 1} K$
  is calculated in the post-processing phase by the formula
  \begin{equation}
    q^{d - 1}(t, c_{d - 1}) =
    \begin{cases}
      ((-1)^{d - 1} \star_1 \tilde{\kappa}_1 \delta_0 u^0)(t, c_{d - 1}),
        & c_{d - 1} \in K_{d - 1} \setminus (\Gamma_N)_{d - 1} \\
      g_N^{d - 1}(t, c_{d - 1}), & c_{d - 1} \in (\Gamma_N)_{d - 1}
    \end{cases},\ t \in I.
  \end{equation}
\end{formulation}
