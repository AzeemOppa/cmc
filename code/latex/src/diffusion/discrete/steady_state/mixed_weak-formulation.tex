\begin{formulation}
  \label{cmc/diffusion/discrete/steady_state/mixed_weak-formulation}
  [Mixed weak formulation for the steady-state continuous heat
  equation with differential forms]
  The following formulation is a discrete version of
  \Cref{cmc/diffusion/continuous/steady_state/mixed_weak-formulation}.
  Let:
  \begin{itemize}
    \item
      $D$ be a positive integer (space dimension);
    \item
      $K$ be an oriented quasi-cubical \hyperref[cmc:mesh:definition]{mesh} of
      dimension $D$ representing the material body;
    \item
      $[K]$ be the fundamental class of $K$;
    \item
      $\kappa [E L^{2 - D} T^{-1} \Theta^{-1}]
      \colon C^{D - 1} K \to C^{D - 1} K$
      be the thermal conductivity of the material, such that for any hyperface
      $c_{D - 1} \in K_{D - 1}$, there exists some $\lambda > 0$ such that
      $\kappa(c^{D - 1}) = \lambda c^{D - 1}$;
    \item
      $f [E T^{-1}] \in C^D K$ be the internal production rate;
    \item
      $\partial K = \Gamma_D \cup \Gamma_N$ be the partition of the boundary of
      $K$ into Dirichlet ($\Gamma_D$) and Neumann ($\Gamma_N$) regions;
    \item
      $[\Gamma_D]$ be the fundamental class of $\Gamma_D$, where $\Gamma_D$
      has the boundary orientation induced from $K$;
    \item
      $g_D [\Theta] \in C^0 \Gamma_D$
      be the prescribed temperature on the Dirichlet boundary;
    \item
      $g_N [E T^{-1}] \in C^{D - 1} \Gamma_N$
      be the prescribed flow rate on the Neumann boundary.
  \end{itemize}
  Define the following operators:
  \begin{subequations}
    \begin{alignat}{3}
      & A \colon C^{D - 1} K \times C^{D - 1} K \to \R, \quad
      && A(r, s)
        := \inner{r}{\kappa^{-1} s}_{K, D - 1} \qquad
      && [E^{-1} T \Theta], \\
      %
      & B \colon C^D K \times C^{D - 1} K \to \R, \quad
      && B(\tilde{v}, r)
        := \inner{\delta_{D - 1} r}{\tilde{v}}_{K, D} \qquad
      && [L^{-D}], \\
      %
      & G \colon C^{D - 1} K \to \R, \quad
      && G(r)
        := (\tr_{\Gamma_D, D - 1} r \smile g_D)[\Gamma_D] \qquad
      && [\Theta], \\
      %
      & F \colon C^D K \to \R, \quad
      && F(\tilde{v}) := \inner{f}{\tilde{v}}_{K, D} \qquad
      && [E T^{-1} L^{-D}].
    \end{alignat}
  \end{subequations}
  Our unknowns are:
  \begin{itemize}
    \item $q [E T^{-1}] \in C^{D - 1} K$ (heat flow rate);
    \item $\tilde{u} [\Theta L^D] \in C^D K$ (dual temperature).
  \end{itemize}
  We are solving the following problem for $q$ and $\tilde{u}$:
  \begin{subequations}
    \begin{alignat}{4}
      & \forall r [E T^{-1}] \in \Ker \tr_{\Gamma_N, D - 1}, \quad
      && A(r, q) - B^T(r, \tilde{u})
      && = - G(r) \qquad
      && [E T^{-1} \Theta], \\
      %
      & \forall \tilde{v} [\Theta L^D] \in C^D K, \quad
      && - B(\tilde{v}, q)
      && = - F(\tilde{v}) \qquad
      && [E T^{-1} \Theta], \\
      %
      &
      && \tr_{\Gamma_N, D - 1} q
      && = g_N \qquad
      && [E T^{-1}].
    \end{alignat}
  \end{subequations}
  The temperature $u [\Theta] \in C^0 K$ is calculated in the
  post-processing phase by the formula
  \begin{equation}
    u(a_0) :=
    \begin{cases}
      (\star_d \tilde{u})(a_0), & a_0 \notin (\Gamma_D)_0 \\
      g_D(a_0), & a_0 \in (\Gamma_D)_0
    \end{cases}.
  \end{equation}
\end{formulation}
