\begin{formulation}
  \label{cmc/diffusion/continuous/steady_state/primal_weak-formulation}
  [Primal weak formulation for the steady-state continuous heat equation
    with differential forms]
  Let:
  \begin{itemize}
    \item
      $D$ be a positive integer (space dimension);
    \item
      $X$ be an open region in $\R^D$, representing a material body;
    \item
      $\tilde{\kappa} [E L^{-1} T^{-1} \Theta^{-1}]
      \colon \Omega^1 X \to \Omega^1 X$
      be the thermal conductivity of the material;
    \item
      $f [E T^{-1}] \in \Omega^D X$ be the internal production rate;
    \item
      $\partial X = \Gamma_D \cup \Gamma_N$ be the partition of the boundary of
      $X$ into Dirichlet ($\Gamma_D$) and Neumann ($\Gamma_N$) regions;
    \item
      $g_D [\Theta] \in \Omega^0 \Gamma_D$
      be the prescribed temperature on the Dirichlet boundary;
    \item
      $g_N [E T^{-1}] \in \Omega^{D - 1} \Gamma_N$
      be the prescribed flow rate on the Neumann boundary.
  \end{itemize}
  Our unknowns is temperature $u [\Theta] \in \Omega^0 X$.
  We are solving the following problem for $u$:
  \begin{subequations}
    \begin{alignat}{4}
      & \forall v \in \Ker \tr_{\Gamma_D, 0}, \quad
      && \inner{d_0 v}{\tilde{\kappa} d_0 u}_{X, 1}
      && = \int_X (v \wedge f)
        - \int_{\Gamma_N} (\tr_{\Gamma_N, 0} v \wedge g_N) \qquad
      && [E T^{-1} \Theta], \\
      %
      &
      && \tr_{\Gamma_D, 0} u
      && = g_D \qquad
      && [\Theta].
    \end{alignat}
  \end{subequations}
  The flow rate $q [E T^{-1}] \in \Omega^{D - 1} X$
  is calculated by the formula
  \begin{equation}
    q(x) :=
    \begin{cases}
      (- \star_1 \tilde{\kappa} d_0 u)(x), & x \notin \Gamma_N \\
      g_N(x), & x \in \Gamma_N
    \end{cases}.
  \end{equation}
\end{formulation}
