\begin{formulation}
  \label{cmc/diffusion/continuous/transient/mixed_weak-formulation}
  [Mixed weak formulation for the transient continuous heat equation with
  differential forms]
  Let:
  \begin{itemize}
    \item
      $D$ be a positive integer (space dimension);
    \item
      $X$ be a $D$-dimensional open region, representing a material body;
    \item
      $t_0 \in \R$ be the initial time;
    \item
      $I = [t_0, \infty)$ be the time-interval where the process occurs;
    \item
      $f [E T^{-1}] \colon I \to \Omega^D X$ be the internal production rate;
    \item
      $u_0 [\Theta] \in \Omega^0 X$ be the initial temperature;
    \item
      $\kappa [E L^{2 - D} T^{-1} \Theta^{-1}]
      \colon \Omega^{D - 1} X \to \Omega^{D - 1} X$
      be the thermal conductivity of the material;
    \item
      $\pi [E L^{-D} \Theta^{-1}] \colon \Omega^D X \to \Omega^D X$
      be the heat capacity of the material;
    \item
      $\partial X = \Gamma_D \cup \Gamma_N$ be the partition of the boundary of
      $X$ into Dirichlet ($\Gamma_D$) and Neumann ($\Gamma_N$) regions;
    \item
      $g_D [\Theta] \colon I \to \Omega^0 \Gamma_D$
      be the prescribed temperature on the Dirichlet boundary;
    \item
      $g_N [E T^{-1}] \colon I \to \Omega^{D - 1} \Gamma_N$
      be the prescribed flow rate on the Neumann boundary.
  \end{itemize}
  Define the following operators:
  \begin{subequations}
    \begin{alignat}{3}
      & A \colon \Omega^{D - 1} X \times (I \to \Omega^{D - 1} X) \to \R,
        \;
      && A(r, s)
        := \inner{r}{\kappa^{-1} s}_{X, D - 1} \;
      && [E^{-1} T \Theta], \\
      %
      & B \colon \Omega^D X \times (I \to \Omega^{D - 1} X) \to \R, \;
      && B(\tilde{w}, r)
        := \inner{d_{D - 1} r}{\tilde{w}}_{X, D} \;
      && [L^{-D}], \\
      %
      & C \colon \Omega^D X \times (I \to \Omega^D X) \to \R, \;
      && C(\tilde{w}, w^D) := \inner{\pi w^D}{\tilde{w}}_{X, D} \;
      && [E L^{-2D} \Theta^{-1}], \\
      %
      & G \colon \Omega^{D - 1} X \to \R, \;
      && G(r)
        := \int_{\Gamma_D} (\tr_{\Gamma_D, D - 1} r \wedge g_D)
        \;
      && [\Theta], \\
      %
      & F \colon \Omega^D X \to \R, \;
      && F(\tilde{w}) := \inner{f}{\tilde{w}}_{X, D} \;
      && [E T^{-1} L^{-D}].
    \end{alignat}
  \end{subequations}
  Our unknowns are:
  \begin{itemize}
    \item
      $q [E T^{-1}] \colon I \to \Omega^{D - 1} X$ (heat flow rate);
    \item
      $\tilde{u} [\Theta L^D] \colon I \to \Omega^D X$ (dual temperature).
  \end{itemize}
  We are solving the following problem for $q$ and $\tilde{u}$:
  \begin{subequations}
    \begin{alignat}{4}
      & \forall r [E T^{-1}] \in \Ker \tr_{\Gamma_N, D - 1}, \;
      && A(r, q) - B^T(r, \tilde{u})
      && = - G(r) \;
      && [E T^{-1} \Theta], \\
      %
      & \forall \tilde{w} [\Theta L^D] \in \Omega^D X, \;
      && - B(\tilde{w}, q) - C(\tilde{w}, \frac{\partial \tilde{u}}{\partial t})
      && = - F(\tilde{w}) \;
      && [E T^{-1} \Theta], \\
      %
      &
      && \tr_{\Gamma_N, D - 1} q
      && = g_N \;
      && [E T^{-1}], \\
      %
      &
      && \tilde{u}(t_0)
      && = \star_{X, 0} u_0 \;
      && [\Theta L^D].
    \end{alignat}
  \end{subequations}
  The temperature $u [\Theta] \colon I \to \Omega^0 X$ is calculated in the
  post-processing phase by the formula
  \begin{equation}
    u(t, x) :=
    \begin{cases}
      u_0(x), & t = t_0 \\
      (\star_D \tilde{u})(t, x), & t > t_0\ \text{and}\ x \notin \Gamma_D \\
      g_D(t, x), & t_0 > 0\ \text{and}\ x \in \Gamma_D
    \end{cases}.
  \end{equation}
\end{formulation}
